---
layout: default
title:  "Play FPGA"
date:   2021-11-13 15:52:05 +0800
categories: Electronic
---

# Background

This term I'm playing FPGA, I begin with Xilinx Artix 7, Basys 3. In this process, many bugs are met and solved, contributing this blog.

Thanks for *Dram*, *Xuzhao Hou*'s help.



# Vivado logic

Vivado is a monstrous software comparing with programming IDE. Understanding its logic is important.

## Sources

Sources consists following  file types: 

1. Design sources: modules, block diagrams which will be synthesised will be put here(**Set as top to be synthesised**)
2. Contraints: files containing information of pin specification. 
3. Simulation sources: files containing simulation information.ï¼ˆ**Set as top will choose the simulation file to be run**), typically one simulation file for one module, module `A`'s sim file will be names `A_tb` (test bench)









# Block design

For some reason, I began with block design under teachers' instructions. The first EDA homework is using block design to construct a four bit plus-minus caculator. I use 74 series IP core to build block diagram. However, this is not a conventional development method in real design. Typically, block design is used with a complex set of modules, rather than simple logic gates. However, the workflow with block design is still worth learning.

## Block design workflow

1. Add the IP core. In **Tools->>Settings->>IP->>Repository ** add repository 
2. Build block diagram. In **IP INTEGRATOR->>Create Block Design**, then draw diagram, finally add the port. (Pay attention to port type)
3. Generate output products **Right click the block file(.bd)->>Generate output products**
4. Create HDL wrapper. After create HDL wrapper, the block design will be seen as a module and be instantiated. **Right click the .bd file->>Create HDL wrapper ->>Choose automatic**
4. Package: After testing. **Tools->>Create and Package New IP->>Package a block design...**(Every packaged IP should be placed in an independent folder)



# Simulation sources 

Testbench references: https://verilogguide.readthedocs.io/en/latest/verilog/testbench.html

```verilog
#1 // # means delay
// for a module with 4 inputs, we often need to tranverse them in testbench
initial begin
  for(integer i=0;i <16 ; i=i+1) begin //attention int may not work here
    {a,b,c,d} = i; //{a,b,c,d} with concatenate input variables
  end
end
```







Input(from MSE to LSE): a3a2a1,b3b2b1

Output(from MSE to LSE): S3S2S1 
